# 9월 19일

<br>

💻 **오늘 배운 것**

---

## 렌더링이란?

> HTML, CSS, JavaScript 등의 문서가 브라우저에서 출력되는 과정
> 즉, 실시간으로 웹사이트가 그려지는 과정

- 대부분의 웹브라우저는 렌더링 엔진과 자바스크립트 엔진으로 구성된다.

  - 렌더링 엔진 : 웹사이트의 소스코드를 읽어 화면에 그려낸다
  - 자바스크립트 엔진 : 자바스크립트 코드를 읽어 기능을 작동시킨다

  <br><br>

## 렌더링 과정

- 사용자가 브라우저를 통해 웹사이트에 접속하면 서버로부터 HTML, CSS등 웹사이트를 그리는데 필요한 리소스를 다운로드 받게 된다.

<br>

### 1. DOM Tree 생성

- 가장 먼저 HTML파일을 DOM Tree로 변환(파싱)한다
- HTML 마크업으로 정의된 여러 태그 간의 관계를 해석해 트리구조로 연결하는 것
- `<link>` , `<img>` 등의 태그를 만나면 리소스를 다운로드한다
- `<script>` 태그를 만나면 DOM 파싱을 중단하고 자바스크립트를 해석한다

<br>

### 2.CSSOM (CSS Object Model) Tree 생성

- HTML 파싱 중 외부 CSS파일 혹은 HTML문서 내 `<style>` 태그에 작성된 스타일을 만나면 이를 파싱해 CSSOM Tree를 구성한다
- DOM Tree를 생성하는 과정과 동일한 과정으로 CSSOM Tree를 생성하는 것
- CSSOM 정보를 통해 DOM 노드에 대한 스타일을 결정(computed style)한다

<br>

### 3. Render Tree 생성

- DOM Tree와 CSSOM Tree를 매칭해 Render Tree를 생성한다
- 렌더 트리에는 페이지를 렌더링하는데에 필요한 노드만, 즉 브라우저에 표시될 정보만 담긴다 (display: none; 과 같이 설정된 요소는 렌더 트리에 포함되지 않음)

<br>

### 4. Layout 단계

- Render Tree에 있는 노드들을 뷰포트 내에 어떻게 배치할 것인지 각 노드의 정확한 위치와 크기를 계산한다.

<br>

### 5. Paint 단계

- Render Tree를 따라 페인트 기록이 생성, 요소를 렌더링하는 순서가 저장된다
- Layout 단계에서 계산된 값을 이용해 각 노드를 화면상의 실제 픽셀로 변환한다
- 픽셀로 변환된 결과는 여러개의 레이어로 나누어 관리된다

<br>

### 6. 컴포지팅(Composite) 단계

- 각각의 레이어를 합성해 실제 화면에 나타낸다

<br>

---

<br>

## Reflow & Repaint

- Reflow
  - HTML의 구조상의 변화, 혹은 기존 요소의 스타일의 변화로 인해 레이아웃(너비, 높이 등)이 변경된 노드에 대해 렌더 트리 생성과 레이아웃 과정을 다시 수행하는 것
- Repaint

  - reflow 과정이 끝난 후 재생성된 렌더 트리를 다시 페인팅하는 것

  <br>

💡 리플로우-리페인팅으로 인한 브라우저의 부담을 덜기 위해 GPU(Graphic Processing Unit)을 통해 그래픽 가속능력을 사용할 수 있다. 이러한 능력을 지원하는 CSS 속성이 바로 `transform` ❗

따라서 동적으로 요소의 위치를 이동해야 하는 경우 `position` 속성이 아닌 `transform` 속성을 사용하는 것이 성능에 좋다.

💡 리플로우가 일어나면 반드시 리페인트가 일어나지만, 레이아웃에 영향을 미치지 않는 단순한 변경사항(ex. 배경색 변경 등)은 리플로우 수행 없이 바로 리페인트만 수행하게 된다.
